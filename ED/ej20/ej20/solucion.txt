https://github.com/behergue/ACR/blob/master/Algorithms/ACR384.cpp